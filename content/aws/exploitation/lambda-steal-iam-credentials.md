---
author: Nick Frichette
title: Steal IAM Credentials and Event Data from Lambda
description: Leverage file read and SSRF vulnerabilities to steam IAM credentials and event data from Lambda
enableEditBtn: true
editBaseURL: https://github.com/Hacking-the-Cloud/hackingthe.cloud/blob/master/content
---
In Lambda, IAM credentials are passed into the function via environment variables. The benefit for the adversary is that these credentials can be leaked via file read vulnerabilities such as [XML External Entity](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A4-XML_External_Entities_(XXE)) attacks or SSRF that allows the file protocol. This is because "[everything is a file](https://en.wikipedia.org/wiki/Everything_is_a_file)".

IAM credentials can be accessed via reading <code>/proc/self/environ</code>

![Credentials](/images/aws/exploitation/lambda-steal-iam-credentials/credentials.png)

{{< notice success "Note" >}}
In the event that /proc/self/environ is blocked by a WAF, check if you can read the environment variables of other processes. This can be done by reading /proc/#/environ where '#' is some number often between 1 and 20.
{{< /notice >}}

In addition to IAM credentials, Lambda functions also have event data that is passed to the function when it is started. Unlike the IAM credentials, this data is accessible over standard SSRF at http://localhost:9001/2018-06-01/runtime/invocation/next.

This will include information about what invoked the Lambda function and may be valuable depending on the context.